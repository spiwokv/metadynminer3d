<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools to Read, Analyze and Visualize Metadynamics 3D HILLS Files from Plumed â€¢ metadynminer3d</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tools to Read, Analyze and Visualize Metadynamics 3D HILLS Files from Plumed">
<meta property="og:description" content="Metadynamics is a state of the art biomolecular simulation technique.
  Plumed Tribello, G.A. et al. (2014) &lt;doi:10.1016/j.cpc.2013.09.018&gt; program makes
  it possible to perform metadynamics using various simulation codes. The results of
  metadynamics done in Plumed can be analyzed by metadynminer. The package
  metadynminer reads 1D and 2D metadynamics hills files from Plumed package.
  As an addendum, metadynaminer3d is used to visualize 3D hills. It uses
  a fast algorithm by Hosek, P. and Spiwok, V. (2016) &lt;doi:10.1016/j.cpc.2015.08.037&gt;
  to calculate a free energy surface from hills. Minima can be located and plotted on
  the free energy surface. Free energy surfaces and minima can be plotted to produce
  publication quality images.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">metadynminer3d</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="metadynminer3d">MetadynMiner3d<a class="anchor" aria-label="anchor" href="#metadynminer3d"></a>
</h1></div>
<div class="section level2">
<h2 id="web-site">Web site<a class="anchor" aria-label="anchor" href="#web-site"></a>
</h2>
<p><a href="http://metadynamics.cz/metadynminer3d/" class="external-link uri">http://metadynamics.cz/metadynminer3d/</a></p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>MetadynMiner is R packages for reading, analysis and visualization of metadynamics HILLS files produced by Plumed. It reads HILLS files from Plumed, calculates free energy surface by fast Bias Sum algorithm, finds minima and analyses transition paths by Nudged Elastic Band method.</p>
<p>MetadynMiner3d is its addendum for plotting 3D free energy surfaces. It uses RGL package. MetadynMiner3d installs and loads metadynminer automatically.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install from R repository</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"metadynminer3d"</span><span class="op">)</span>

<span class="co"># Install from GitHub by devtools</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"spiwokv/metadynminer3d"</span><span class="op">)</span>

<span class="co"># Load library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.metadynamics.cz/metadynminer3d" class="external-link">metadynminer3d</a></span><span class="op">)</span>
<span class="co"># Read hills file</span>
<span class="va">hillsf</span><span class="op">&lt;-</span><span class="fu"><a href="reference/read.hills3d.html">read.hills3d</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># HILLS with periodicity on CV1, CV2 and CV3</span>

<span class="co"># Sum two hills files</span>
<span class="va">hillsf</span><span class="op">+</span><span class="va">hillsf</span>

<span class="co"># Summary of a hills file</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>

<span class="co"># Plot CVs</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/hills3d.png" alt=""><p class="caption">hills3d</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot heights</span>
<span class="fu"><a href="https://rdrr.io/pkg/metadynminer/man/plotheights.html" class="external-link">plotheights</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/hills3dh.png" alt=""><p class="caption">hills3dh</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate FES by bias sum (alternatively use fes2 for conventional calculation)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/metadynminer/man/fes.html" class="external-link">fes</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>

<span class="co"># Calculate FES for given range (indexes of hills)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/metadynminer/man/fes.html" class="external-link">fes</a></span><span class="op">(</span><span class="va">hillsf</span>, imin<span class="op">=</span><span class="fl">5000</span>, imax<span class="op">=</span><span class="fl">10000</span><span class="op">)</span>

<span class="co"># Sum two FESes</span>
<span class="va">tfes</span><span class="op">+</span><span class="va">tfes</span>

<span class="co"># Calculate and subtract min, max or mean from a FES</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="va">tfes</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>

<span class="co"># Summary of FES</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>

<span class="co"># Plot FES</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, level<span class="op">=</span><span class="fl">20</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/fes3d.png" alt=""><p class="caption">fes3d</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find minima</span>
<span class="va">minima</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/metadynminer/man/fesminima.html" class="external-link">fesminima</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>

<span class="co"># Summary of minima</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span>

<span class="co"># Plot free energy minima</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/min3d.png" alt=""><p class="caption">min3d</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate free energy profile for minima</span>
<span class="va">prof</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/metadynminer/man/feprof.html" class="external-link">feprof</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span>

<span class="co"># Plot free energy profile for minima</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prof</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/prof3d.png" alt=""><p class="caption">prof3d</p>
</div>
</div>
<div class="section level2">
<h2 id="tips-and-tricks">Tips and Tricks<a class="anchor" aria-label="anchor" href="#tips-and-tricks"></a>
</h2>
<div class="section level3">
<h3 id="publication-quality-figures">Publication quality figures<a class="anchor" aria-label="anchor" href="#publication-quality-figures"></a>
</h3>
<p>Following script can be used to generate a publication quality figure:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hillsf</span><span class="op">&lt;-</span><span class="fu"><a href="reference/read.hills3d.html">read.hills3d</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/metadynminer/man/fes.html" class="external-link">fes</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span></code></pre></div>
<p>Change window size, zoom in and rotate if necessary, then (without closing the window) type:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/snapshot.html" class="external-link">rgl.snapshot</a></span><span class="op">(</span>filename<span class="op">=</span><span class="st">"plot.png"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="publication-of-interactive-fes-on-web">Publication of interactive FES on web<a class="anchor" aria-label="anchor" href="#publication-of-interactive-fes-on-web"></a>
</h3>
<p>You can save free energy surface in WebGL and present it on a web site by typing:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/writeWebGL.html" class="external-link">writeWebGL</a></span><span class="op">(</span>filename<span class="op">=</span><span class="st">"fes3d.html"</span><span class="op">)</span></code></pre></div>
<p><a href="https://htmlpreview.github.io/?https://github.com/spiwokv/metadynminer3d/blob/master/figs/fes3d.html" class="external-link">fes3d.html</a></p>
</div>
<div class="section level3">
<h3 id="making-movie">Making movie<a class="anchor" aria-label="anchor" href="#making-movie"></a>
</h3>
<p>It is possible to make movie of rotation of the plot by:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/play3d.html" class="external-link">movie3d</a></span><span class="op">(</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/spin3d.html" class="external-link">spin3d</a></span><span class="op">(</span>axis<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, duration<span class="op">=</span><span class="fl">3</span>, dir<span class="op">=</span><span class="st">"."</span>, type<span class="op">=</span><span class="st">"gif"</span><span class="op">)</span></code></pre></div>
<p>This will create a three-second animated GIF <code>movie.gif</code> file of rotation around z-axis. <img src="./figs/movie.gif" alt="movie"></p>
</div>
<div class="section level3">
<h3 id="modifying-aspect-ratio-of-box">Modifying aspect ratio of box<a class="anchor" aria-label="anchor" href="#modifying-aspect-ratio-of-box"></a>
</h3>
<p>The aspect ratio of the box can be modified by:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/aspect3d.html" class="external-link">aspect3d</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>after <code>plot</code> command. This makes the x-axis twice longer than other axes.</p>
</div>
</div>
<div class="section level2">
<h2 id="training">Training<a class="anchor" aria-label="anchor" href="#training"></a>
</h2>
<p><a href="https://youtu.be/W8N-G8d0or4" class="external-link">MetadynMiner Webinar video</a></p>
<p><a href="https://www.plumed.org/doc-master/user-doc/html/masterclass-22-02.html" class="external-link">Plumed Masterclass tutorial</a></p>
<p><a href="https://youtu.be/T8a-kP6V3_g" class="external-link">Plumed Masterclass video 1</a></p>
<p><a href="https://youtu.be/q1D39A_LQag" class="external-link">Plumed Masterclass video 2</a></p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>Vojtech Spiwok - spiwokv{youknowwhat}vscht.cz</p>
<p>To contribute, se <a href="./CONTRIBUTING.html">CONTRIBUTING.md</a></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=metadynminer3d" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing metadynminer3d</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vojtech Spiwok <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8108-2033" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/spiwokv/metadynminer3d/actions/" class="external-link"><img src="https://github.com/spiwokv/metadynminer3d/actions/workflows/r.yml/badge.svg" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/spiwokv/metadynminer3d" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/spiwokv/metadynminer3d?branch=master&amp;svg=true" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=metadynminer3d" class="external-link"><img src="https://www.r-pkg.org/badges/version/metadynminer3d" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=metadynminer3d" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/metadynminer3d" alt="CRAN downloads"></a></li>
<li><a href="http://www.rdocumentation.org/packages/metadynminer3d" class="external-link"><img src="http://api.rdocumentation.org/badges/version/metadynminer3d" alt="Rdoc"></a></li>
<li><a href="https://codecov.io/gh/spiwokv/metadynminer3d/" class="external-link"><img src="https://codecov.io/gh/spiwokv/metadynminer3d/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Vojtech Spiwok.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
